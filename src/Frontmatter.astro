---
import type { SchemaMeta } from './index';
import { getRegistry } from './index';
import { components } from 'virtual:astro-frontmatter-components';

type Props = {
	blocks?: SchemaMeta[];
	callback?: (data: SchemaMeta, i: number) => void;
};
const { blocks, callback } = Astro.props;

const registry = getRegistry();
---

{
	blocks?.map(async (props, i) => {
		const section = registry[props.type];
		if (callback) {
			callback(props, i);
		}

		const Component = components[section.type];
		return <Component {...props} />;
	})
}
