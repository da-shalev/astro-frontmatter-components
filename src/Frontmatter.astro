---
import { getRegistry, type SchemaMeta } from './integration';

type Props = {
	blocks?: SchemaMeta[];
	callback?: (data: SchemaMeta, i: number) => void;
};
const { blocks, callback } = Astro.props;

const registry = getRegistry();
const { components } = await import('virtual:astro-frontmatter-components');
---

{
	blocks?.map(async (props, i) => {
		if (callback) {
			callback(props, i);
		}

		const block = registry.components[props.type];
		const Component = components[block.type];
		return <Component {...props} />;
	})
}
